<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Leveraging DTO pattern in Go-based web apps · Tarka Labs - Tarka Labs</title><meta name="gridsome:hash" content="b2812328144f18df2feed7567fe3f287870ecb29"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="viewport" content="width=device-width, initial-scale=1.0"><meta data-vue-tag="ssr" property="og:title" content="Leveraging DTO pattern in Go-based web apps · Tarka Labs"><meta data-vue-tag="ssr" property="og:description" content="Leveraging DTO pattern in Go-based web apps"><meta data-vue-tag="ssr" property="og:image" content="/assets/img/go-dto-pattern.4d5aa661.webp"><meta data-vue-tag="ssr" property="og:image:height" content="627"><meta data-vue-tag="ssr" property="og:image:width" content="1200"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.92f6d0f06feb6aec5e019521ff224fd8.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.92f6d0f06feb6aec5e019521ff224fd8.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.92f6d0f06feb6aec5e019521ff224fd8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.92f6d0f06feb6aec5e019521ff224fd8.png"><link rel="preload" href="/assets/css/0.styles.14fdcb10.css" as="style"><link rel="preload" href="/assets/js/app.e17012a2.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--blog-vue.ecffc636.js" as="script"><link rel="stylesheet" href="/assets/css/0.styles.14fdcb10.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
    <meta
      name="google-site-verification"
      content="j7cLUK-kxGEpMOY7valSkamH4kQe_l38yMMAXbpk19U"
    />
    <noscript>
      <div class="noscript-container">
        <a href="/" class="noscript-logo">Tarka <br />_Labs</a>
        <div class="noscript-text-container">
          <h1>Uh oh! Looks like <span>JavaScript</span> is disabled.</h1>
          <p>
            Bitman requires <span>JavaScript</span> to fuel his thirst to end
            bad UX and lazy design, which is necessary to give you the best
            viewing experience possible. Please enable it to continue to our
            website.
          </p>
        </div>
      </div>
    </noscript>
  </head>

  <body >
    <div><div id="app" data-server-rendered="true" data-v-b5a9baaa><div data-v-b5a9baaa><div id="banner-section" data-v-b5a9baaa><div class="banner" style="background:;display:none;" data-v-b5a9baaa><div class="layout" data-v-b5a9baaa><div data-v-b5a9baaa></div><div class="hero heading-size-5" style="color:#ffffff;" data-v-b5a9baaa></div><div data-v-b5a9baaa></div></div></div><div data-v-b5a9baaa></div></div><div class="sidebar" data-v-d6d2017e data-v-b5a9baaa><div class="nav" data-v-d6d2017e><div class="fixed" data-v-d6d2017e><a href="/" data-v-9b1a4c9c data-v-d6d2017e> TARKA<br data-v-9b1a4c9c>_LABS </a><div class="menu" data-v-50705736 data-v-d6d2017e><div class="control" style="stroke:black;" data-v-50705736><div class="spinner heading-size-9" data-v-48940e1e data-v-50705736><span class="side-menu-symbol" data-v-48940e1e><span class="menu-symbol rotate180t90" data-v-48940e1e><svg height="10" width="10" data-v-48940e1e><line x1="0" y1="5" x2="10" y2="5" style="stroke-width: 2" data-v-48940e1e></line></svg></span><span class="menu-symbol rotate90t0" data-v-48940e1e><svg height="10" width="10" data-v-48940e1e><line x1="0" y1="5" x2="10" y2="5" style="stroke-width: 2" data-v-48940e1e></line></svg></span></span><span class="Spinner-text" data-v-48940e1e> menu </span></div><div class="active-page body-jetbrains-size-11 fade-in" data-v-4767b8ae data-v-50705736>
  
</div></div><div class="items hidden" data-v-50705736><ul class="main-nav" data-v-20ea19cd data-v-50705736><div class="primary fadeOut sidebar" data-v-20ea19cd><li data-v-20ea19cd><a href="https://design.tarkalabs.com/" target="_self" data-v-20ea19cd>/Design</a></li><li data-v-20ea19cd><a href="/develop" data-v-20ea19cd>/Develop</a></li><li data-v-20ea19cd><a href="/projects" data-v-20ea19cd>/Case_Studies</a></li><li data-v-20ea19cd><a href="/careers" data-v-20ea19cd>/Careers</a></li><li data-v-20ea19cd><a href="/about" data-v-20ea19cd>/About</a></li><li data-v-20ea19cd><a href="/contact" data-v-20ea19cd>/Contact</a></li></div></ul><ul class="sub body-jetbrains-size-11 fadeOut sidebar" data-v-3cc3824e data-v-50705736><li data-v-3cc3824e><a href="/blogs" class="active" data-v-3cc3824e>/blogs</a></li><li data-v-3cc3824e><a href="/talks" data-v-3cc3824e>/talks</a></li><li data-v-3cc3824e><a href="/train" data-v-3cc3824e>/train</a></li></ul></div></div><a href="/contact" class="heading-size-9" data-v-573e12d8 data-v-d6d2017e>
  Get in<br data-v-573e12d8>touch<span class="arrow" data-v-573e12d8>-&gt;</span></a></div></div><!----></div><div class="baseLayout" data-v-996dafb6 data-v-b5a9baaa><div data-v-996dafb6></div><div data-v-996dafb6><div class="blog-details-page" data-v-996dafb6><div class="inner-section" data-v-996dafb6><p class="heading-size-10 capitalize" data-v-996dafb6>
        /web - 4 min read
      </p><h1 class="title" data-v-996dafb6>Leveraging DTO pattern in Go-based web apps</h1><div class="author-basic-info" data-v-996dafb6><img src="/assets/img/shamil.116f5579.png" alt="Shamil Siddique" width="64" data-v-996dafb6><div data-v-996dafb6><p class="heading-size-9 capitalize" data-v-996dafb6>Shamil Siddique</p><p class="body-jetbrains-size-10" data-v-996dafb6>
            Developer
          </p></div></div></div><img src="/assets/img/go-dto-pattern.4d5aa661.webp" alt="Leveraging DTO pattern in Go-based web apps" class="header-img" data-v-996dafb6><div class="toc-wrapper" data-v-996dafb6><h2 class="heading-size-7" data-v-996dafb6>Table of contents</h2><div class="toc" data-v-996dafb6><a href="#content" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/01</p><p data-v-996dafb6>Intro</p></a><a href="#toc-section-1" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/02</p><p data-v-996dafb6>DTO Naming strategy</p></a><a href="#toc-section-2" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/03</p><p data-v-996dafb6>Parsing and Validation</p></a><a href="#toc-section-3" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/04</p><p data-v-996dafb6>Conclusion</p></a></div></div><div id="content" class="content" data-v-996dafb6><p>I’ll start by confessing a certain bias — I love statically-typed languages.
The level of control and certainty they offer compared to dynamically-typed languages is something I always drool over.</p>
<p>This admiration extends to the benefits that the DTO (Data Transfer Object) pattern brings to the table.
The DTO pattern is a design strategy used to transfer data between software application subsystems.
It ensures structure, which tickles my love for control in my apps.</p>
<p>In this article, we’ll go through the implementation of DTO pattern in Go-based API.
I’ll explain my DTO naming strategy as well as parsing and validation logic.
For simplicity, I’ll be writing the parsing and validation part for Go Fiber framework, but most of the code can be reused for vanilla Go or other frameworks like Gorilla.</p>
<h1 id="toc-section-1"><a href="#dto-naming-strategy" aria-hidden="true"><span class="icon icon-link"></span></a>DTO Naming strategy</h1>
<p>I usually follow a set of general rules when naming DTOs for API. These rules work for almost all CRUD cases and a couple of other cases.
If they are not applicable, I try improvising on top of them.</p>
<p>The entity/model that is going to be affected (Article, Authentication, Socket, etc) makes the first word in the name.
This can be omitted if the action in second point is self-defining (for example, authentication).
The type of action (Create, Update, Signup, etc) comes second in the name. They can be chained or omitted if being re-used or if not applicable.
Whether it is for Request or Response forms the third part of the name, and it’ll be omitted if they are reused for both.
The DTOs are grouped into a file based on the first part of its name in singular form, which is the entity/model it affects.
I’ll give a few examples which apply these rules:</p>
<ul>
<li><code class="language-inline-text">dtos/article.go</code> may contain CRUD DTOs like ArticleListResponseDto, ArticleCreateRequestDto, ArticleCreateUpdateResponseDto, etc.</li>
<li><code class="language-inline-text">dtos/authentication.go</code> may contain more action based DTOs like SigninRequestDto, SignupRequestDto, etc.</li>
<li><code class="language-inline-text">dtos/socket.go</code> may contain generic DTOs like SocketRequestDto, SocketResponseDto, etc.</li>
</ul>
<h1 id="toc-section-2"><a href="#parsing-and-validation" aria-hidden="true"><span class="icon icon-link"></span></a>Parsing and Validation</h1>
<p>I use tags to assist in parsing to and from JSON.
Tags can also be used for defining rules for each field in the DTO and validating using the <a href="https://pkg.go.dev/github.com/go-playground/validator/v10" target="_blank" rel="nofollow noopener noreferrer">validator</a> package.
So, my DTOs might looks like:</p>
<div class="gridsome-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">type</span> SignupRequestDTO <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  Name     <span class="token builtin">string</span> <span class="token string">`json:"name" validate:"required"`</span>
  Username <span class="token builtin">string</span> <span class="token string">`json:"username" validate:"required"`</span>
  Email    <span class="token builtin">string</span> <span class="token string">`json:"email" validate:"required,min=5"`</span>
  Password <span class="token builtin">string</span> <span class="token string">`json:"password" validate:"required,min=8"`</span>
<span class="token punctuation">}</span></code></pre></div>
<p>I personally do the parsing and validation in a single util method.
This is because failure in parsing would also indicate a validation failure on the request body structure.
If parsing works out well, we can validate other constraints we set for the DTO fields using the validate tags.
We loop through the validation errors and generate appropriate error messages for them.</p>
<div class="gridsome-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">ParseAndValidateRequest</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fiber<span class="token punctuation">.</span>Ctx<span class="token punctuation">,</span> dto any<span class="token punctuation">)</span> fiber<span class="token punctuation">.</span>Map <span class="token punctuation">{</span>
  <span class="token keyword">if</span> err <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">BodyParser</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    errors <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">"Unable to parse request"</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> fiber<span class="token punctuation">.</span>Map<span class="token punctuation">{</span><span class="token string">"errors"</span><span class="token punctuation">:</span> errors<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> err <span class="token operator">:=</span> validator<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Struct</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    errors <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token keyword">range</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span>validator<span class="token punctuation">.</span>ValidationErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      errors <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> <span class="token function">generateErrorString</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fiber<span class="token punctuation">.</span>Map<span class="token punctuation">{</span><span class="token string">"errors"</span><span class="token punctuation">:</span> errors<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The <code class="language-inline-text">generateErrorString</code> method used here is a small method to generate error strings for a given FieldError.
It checks the tag associated with the error and generates appropriate error message.</p>
<div class="gridsome-highlight" data-language="go"><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">generateErrorString</span><span class="token punctuation">(</span>err validator<span class="token punctuation">.</span>FieldError<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  field<span class="token punctuation">,</span> tag<span class="token punctuation">,</span> param <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">switch</span> tag <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token string">"min"</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> field <span class="token operator">+</span> <span class="token string">" should have minimum length of "</span> <span class="token operator">+</span> param
  <span class="token keyword">case</span> <span class="token string">"max"</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> field <span class="token operator">+</span> <span class="token string">" should have maximum length of "</span> <span class="token operator">+</span> param
  <span class="token keyword">default</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> field <span class="token operator">+</span> <span class="token string">" is not valid"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>As we add more tags for <a href="https://pkg.go.dev/github.com/go-playground/validator/v10#section-documentation" target="_blank" rel="nofollow noopener noreferrer">validate</a>, we can extend this function to handle more cases.
A full list of tags can be found in its documentation or you can read through is source on <a href="https://github.com/go-playground/validator" target="_blank" rel="nofollow noopener noreferrer">Github</a>.</p>
<p>Now, when I have to parse a request body to DTO, I’ll pass the pointer to the DTO.
The function will parse and map to the fields in DTO passed by its pointer.
If there are any errors, we get a map with errors list inside it.</p>
<div class="gridsome-highlight" data-language="go"><pre class="language-go"><code class="language-go">requestDTO <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>dtos<span class="token punctuation">.</span>SignupRequestDTO<span class="token punctuation">)</span>
<span class="token keyword">if</span> errors <span class="token operator">:=</span> utils<span class="token punctuation">.</span><span class="token function">ParseAndValidateRequest</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> requestDTO<span class="token punctuation">)</span><span class="token punctuation">;</span> errors <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Status</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>StatusUnprocessableEntity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now that I think about it, this errors map returned from the function can also be a DTO 😉.</p>
<h1 id="toc-section-3"><a href="#conclusion" aria-hidden="true"><span class="icon icon-link"></span></a>Conclusion</h1>
<p>Overall, this flow has been pretty convenient to use in my Go-based web projects.
I write validation tags only in Request DTOs and only on fields that require them.
But, I’ve consistently written JSON tags for all fields regardless of whether they are required or not.</p>
<p>Do let me know in the comments if you improvise on this.</p>
</div><hr data-v-996dafb6><div class="inner-section" data-v-996dafb6><div class="author-basic-info" data-v-996dafb6><img src="/assets/img/shamil.116f5579.png" alt="Shamil Siddique" width="64" data-v-996dafb6><div data-v-996dafb6><p class="heading-size-9 capitalize" data-v-996dafb6>Shamil Siddique</p><p class="body-jetbrains-size-10" data-v-996dafb6>
            Developer
          </p></div></div><p class="body-opensans-size-9" data-v-996dafb6>He is still thinking what to write about him</p><div class="social-links" data-v-996dafb6><!----><!----><a href="https://medium.com/@shamilsdq" target="_blank" class="heading-size-9" data-v-996dafb6>
          Medium
        </a></div></div><hr data-v-996dafb6><div class="related-articles" data-v-996dafb6><div class="flex-space-between" data-v-996dafb6><p class="heading-size-7" data-v-996dafb6>_related articles</p><a href="/blogs" class="heading-size-9 underline" data-v-996dafb6>View all</a></div><div class="flex-space-between blog-card-wrapper" data-v-996dafb6><a href="/blogs/neovim-as-java-ide" class="blog-card" data-v-996dafb6><img src="/assets/img/default-cover.55254b66.png" alt="Neovim as a java IDE" class="thumbnail" data-v-996dafb6><div class="info" data-v-996dafb6><p class="heading-size-10 capitalize" data-v-996dafb6>/web</p><h3 data-v-996dafb6>Neovim as a java IDE</h3><p class="body-jetbrains-size-10" data-v-996dafb6>
              Dhruva Sagar   5 min read
            </p></div></a><a href="/blogs/kafka-message-duplication" class="blog-card" data-v-996dafb6><img src="/assets/img/kafka-message-duplication.30a6cddc.webp" alt="Handling message duplication in Kafka" class="thumbnail" data-v-996dafb6><div class="info" data-v-996dafb6><p class="heading-size-10 capitalize" data-v-996dafb6>/web</p><h3 data-v-996dafb6>Handling message duplication in Kafka</h3><p class="body-jetbrains-size-10" data-v-996dafb6>
              Vignesh Ravichandran   5 min read
            </p></div></a></div></div><div class="lets-talk" data-v-188e6a71><div class="message heading-size-7" data-v-188e6a71>
    Let’s build digital solutions together.
  </div><div class="action-container" data-v-188e6a71><div class="action-button heading-size-5" data-v-188e6a71><div data-v-188e6a71>Get in touch</div><div class="arrow" data-v-188e6a71>-&gt;</div></div><img src="/assets/img/talk.71d1d2f3.svg" alt="Lenny Face" data-v-188e6a71></div></div></div></div><div data-v-996dafb6></div></div><div id="footer" class="baseLayout" data-v-996dafb6 data-v-b5a9baaa><div data-v-996dafb6></div><div data-v-996dafb6><div class="site-footer" data-v-0a037a4b data-v-b5a9baaa><ul class="main-nav footer" data-v-20ea19cd data-v-0a037a4b><div class="primary fadeIn" data-v-20ea19cd><li data-v-20ea19cd><a href="https://design.tarkalabs.com/" target="_self" data-v-20ea19cd>/Design</a></li><li data-v-20ea19cd><a href="/develop" data-v-20ea19cd>/Develop</a></li><li data-v-20ea19cd><a href="/projects" data-v-20ea19cd>/Case_Studies</a></li><li data-v-20ea19cd><a href="/careers" data-v-20ea19cd>/Careers</a></li><li data-v-20ea19cd><a href="/about" data-v-20ea19cd>/About</a></li><li data-v-20ea19cd><a href="/contact" data-v-20ea19cd>/Contact</a></li></div></ul><div class="subnav" data-v-0a037a4b><ul class="sub body-jetbrains-size-11 footer fadeIn" data-v-3cc3824e data-v-0a037a4b><li data-v-3cc3824e><a href="/blogs" class="active" data-v-3cc3824e>/blogs</a></li><li data-v-3cc3824e><a href="/talks" data-v-3cc3824e>/talks</a></li><li data-v-3cc3824e><a href="/train" data-v-3cc3824e>/train</a></li></ul><div data-v-fae945d8 data-v-0a037a4b><a href="https://twitter.com/tarkalabs" target="_blank" rel="noopener" class="external" data-v-fae945d8>Twitter</a><a href="https://in.linkedin.com/company/tarka-labs" target="_blank" rel="noopener" class="external" data-v-fae945d8>LinkedIn</a></div><div class="sedin" data-v-0a037a4b><a href="https://sedintechnologies.com/" target="_blank" rel="noopener" class="external" data-v-0a037a4b>Tarka Labs is a division of Sedin Technologies</a></div></div></div></div><div data-v-996dafb6></div></div></div></div></div>
    <script src="/assets/js/app.e17012a2.js" defer></script><script src="/assets/js/page--src--templates--blog-vue.ecffc636.js" defer></script><script data-vue-tag="ssr" src="https://unpkg.com/@lottiefiles/lottie-player@0.4.0/dist/lottie-player.js" data-body="true"></script>
  </body>
</html>
