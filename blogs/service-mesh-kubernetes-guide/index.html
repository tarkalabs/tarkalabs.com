<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Service Mesh in Kubernetes — Pictorially · Tarka Labs - Tarka Labs</title><meta name="gridsome:hash" content="0cf23ec60406531217e5ce675f99a5997c846f10"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="viewport" content="width=device-width, initial-scale=1.0"><meta data-vue-tag="ssr" property="og:title" content="Service Mesh in Kubernetes — Pictorially · Tarka Labs"><meta data-vue-tag="ssr" property="og:description" content="Service Mesh in Kubernetes — Pictorially"><meta data-vue-tag="ssr" property="og:image" content="/assets/img/service-mesh-2.8e831dba.webp"><meta data-vue-tag="ssr" property="og:image:height" content="627"><meta data-vue-tag="ssr" property="og:image:width" content="1200"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.92f6d0f06feb6aec5e019521ff224fd8.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.92f6d0f06feb6aec5e019521ff224fd8.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.92f6d0f06feb6aec5e019521ff224fd8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.92f6d0f06feb6aec5e019521ff224fd8.png"><link rel="preload" href="/assets/css/0.styles.0834cda1.css" as="style"><link rel="preload" href="/assets/js/app.8e7b5054.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--blog-vue.2099f288.js" as="script"><link rel="stylesheet" href="/assets/css/0.styles.0834cda1.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
    <meta
      name="google-site-verification"
      content="j7cLUK-kxGEpMOY7valSkamH4kQe_l38yMMAXbpk19U"
    />
    <noscript>
      <div class="noscript-container">
        <a href="/" class="noscript-logo">Tarka <br />_Labs</a>
        <div class="noscript-text-container">
          <h1>Uh oh! Looks like <span>JavaScript</span> is disabled.</h1>
          <p>
            Bitman requires <span>JavaScript</span> to fuel his thirst to end
            bad UX and lazy design, which is necessary to give you the best
            viewing experience possible. Please enable it to continue to our
            website.
          </p>
        </div>
      </div>
    </noscript>
  </head>

  <body >
    <div><div id="app" data-server-rendered="true" data-v-b5a9baaa><div data-v-b5a9baaa><div id="banner-section" data-v-b5a9baaa><div class="banner" style="background:;display:none;" data-v-b5a9baaa><div class="layout" data-v-b5a9baaa><div data-v-b5a9baaa></div><div class="hero heading-size-5" style="color:#ffffff;" data-v-b5a9baaa></div><div data-v-b5a9baaa></div></div></div><div data-v-b5a9baaa></div></div><div class="sidebar" data-v-d6d2017e data-v-b5a9baaa><div class="nav" data-v-d6d2017e><div class="fixed" data-v-d6d2017e><a href="/" data-v-9b1a4c9c data-v-d6d2017e> TARKA<br data-v-9b1a4c9c>_LABS </a><div class="menu" data-v-50705736 data-v-d6d2017e><div class="control" style="stroke:black;" data-v-50705736><div class="spinner heading-size-9" data-v-02ea7230 data-v-50705736><span class="side-menu-symbol" data-v-02ea7230><span class="menu-symbol rotate180t90" data-v-02ea7230><svg height="10" width="10" data-v-02ea7230><line x1="0" y1="5" x2="10" y2="5" style="stroke-width: 2" data-v-02ea7230></line></svg></span><span class="menu-symbol rotate90t0" data-v-02ea7230><svg height="10" width="10" data-v-02ea7230><line x1="0" y1="5" x2="10" y2="5" style="stroke-width: 2" data-v-02ea7230></line></svg></span></span><span style="vertical-align: middle" data-v-02ea7230> menu </span></div><div class="active-page body-jetbrains-size-11 fade-in" data-v-128e5feb data-v-50705736>
  
</div></div><div class="items hidden" data-v-50705736><ul class="main-nav" data-v-748716d7 data-v-50705736><div class="primary fadeOut sidebar" data-v-748716d7><li data-v-748716d7><a href="/genai" data-v-748716d7>/GenAI</a></li><li data-v-748716d7><a href="https://design.tarkalabs.com/" target="_self" data-v-748716d7>/Design</a></li><li data-v-748716d7><a href="/develop" data-v-748716d7>/Develop</a></li><li data-v-748716d7><a href="/case-studies" data-v-748716d7>
        /Case_Studies
      </a></li><li data-v-748716d7><a href="/careers" data-v-748716d7>/Careers</a></li><li data-v-748716d7><a href="/about" data-v-748716d7>/About</a></li><li data-v-748716d7><a href="/contact" data-v-748716d7>/Contact</a></li></div></ul><ul class="sub body-jetbrains-size-11 fadeOut sidebar" data-v-3cc3824e data-v-50705736><li data-v-3cc3824e><a href="/blogs" class="active" data-v-3cc3824e>/blogs</a></li><li data-v-3cc3824e><a href="/talks" data-v-3cc3824e>/talks</a></li><li data-v-3cc3824e><a href="/train" data-v-3cc3824e>/train</a></li></ul></div></div><a href="/contact" class="heading-size-9" data-v-573e12d8 data-v-d6d2017e>
  Get in<br data-v-573e12d8>touch<span class="arrow" data-v-573e12d8>-&gt;</span></a></div></div><!----></div><div class="baseLayout" data-v-996dafb6 data-v-b5a9baaa><div data-v-996dafb6></div><div data-v-996dafb6><div class="blog-details-page" data-v-996dafb6><div class="inner-section" data-v-996dafb6><p class="heading-size-10 capitalize" data-v-996dafb6>
        /web - 5 min read
      </p><h1 class="title" data-v-996dafb6>Service Mesh in Kubernetes — Pictorially</h1><div class="author-basic-info" data-v-996dafb6><img src="/assets/img/sudhakar.84c96111.jpg" alt="Sudhakar Rayavaram" width="64" data-v-996dafb6><div data-v-996dafb6><p class="heading-size-9 capitalize" data-v-996dafb6>Sudhakar Rayavaram</p><p class="body-jetbrains-size-10" data-v-996dafb6>
            Developer
          </p></div></div></div><img src="/assets/img/service-mesh-2.8e831dba.webp" alt="Service Mesh in Kubernetes — Pictorially" class="header-img" data-v-996dafb6><div class="toc-wrapper" data-v-996dafb6><h2 class="heading-size-7" data-v-996dafb6>Table of contents</h2><div class="toc" data-v-996dafb6><a href="#content" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/01</p><p data-v-996dafb6>Intro</p></a><a href="#toc-section-1" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/02</p><p data-v-996dafb6>Why Service Mesh?</p></a><a href="#toc-section-2" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/03</p><p data-v-996dafb6>Key Components</p></a><a href="#toc-section-3" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/04</p><p data-v-996dafb6>What can a service mesh do?</p></a><a href="#toc-section-4" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/05</p><p data-v-996dafb6>How does it do it?</p></a><a href="#toc-section-5" class="heading-size-9 heading" data-v-996dafb6><p data-v-996dafb6>/06</p><p data-v-996dafb6>Next steps</p></a></div></div><div id="content" class="content" data-v-996dafb6><p>As part of my learning in devops space, I started exploring service mesh and recently did a <a href="https://open.spotify.com/episode/47tD10ggn0Zjsz8phpCzpw?si=wjecGlNoQ9mpZl-a94V3-Q" target="_blank" rel="nofollow noopener noreferrer">podcast</a>. Here is the blog version which I think will be useful for others to get the big picture</p>
<p>This post assumes you are aware of how kubernetes works at a high level. If not, you could look <a href="https://medium.com/tarkalabs/know-kubernetes-pictorially-f6e6a0052dd0?sk=83ffba6f9236db14e7aef7720769bd27" target="_blank" rel="nofollow noopener noreferrer">this post</a> before</p>
<h1 id="toc-section-1"><a href="#why-service-mesh" aria-hidden="true"><span class="icon icon-link"></span></a>Why Service Mesh?</h1>
<p>So, our kubernetes world with pods, deployments, services and ingress controllers are buzzing with activity and we are happy with the newly gained power to deploy our services easily at will and scale them as we see fit</p>
<figure><img src="/blog/service-mesh-in-kubernetes/service-mesh-1.webp" alt="Refer to my [past article](https://medium.com/tarkalabs/know-kubernetes-pictorially-f6e6a0052dd0?sk=83ffba6f9236db14e7aef7720769bd27) if the above image does not make sense"><figcaption>Refer to my <a href="https://medium.com/tarkalabs/know-kubernetes-pictorially-f6e6a0052dd0?sk=83ffba6f9236db14e7aef7720769bd27">past article</a> if the above image does not make sense</figcaption></figure>
<p>Then, why should we care about another concept called “Service Mesh” and what does that bring to the table? To answer it, Let us think of a scenario where our cluster has grown to have lot more services and they call each other to fulfill a service request (east west traffic) and their inter-dependencies will put spaghetti to shame.</p>
<figure><img src="/blog/service-mesh-in-kubernetes/service-mesh-2.webp" alt="All the envelopes are data packets sent over the network between the nodes"><figcaption>All the envelopes are data packets sent over the network between the nodes</figcaption></figure>
<p>All the kubernetes constructs like Pod, Deployment, Service, Secrets help us to create and deploy our payload (applications) but does very little to observe, manage or control the flow of traffic between them. This is exactly where a service mesh helpsto create and deploy our payload (applications) but does very little to observe, manage or control the flow of traffic between them. This is exactly where a service mesh helps</p>
<h1 id="toc-section-2"><a href="#key-components" aria-hidden="true"><span class="icon icon-link"></span></a>Key Components</h1>
<p>Before we get into the details of how a service mesh does it, Let us quickly go through some of the important concepts in kubernetes that it relies on</p>
<h2 id="sidecar-proxy"><a href="#sidecar-proxy" aria-hidden="true"><span class="icon icon-link"></span></a>Sidecar proxy</h2>
<img src="/blog/service-mesh-in-kubernetes/service-mesh-3.webp">
<p>As the name suggests, A proxy server that runs as a sidecar to the main container intercepting the network traffic and sometimes modifying it (case of mTLS). This decouples the application container (developers concern) from the other responsibilities like securing the traffic, notifying monitoring servers about the traffic (operations concern). The application container can be independently deployed without worrying about proxy</p>
<p><a href="https://istio.io/" target="_blank" rel="nofollow noopener noreferrer">Istio</a>, a service mesh uses envoy proxy where as <a href="https://linkerd.io/" target="_blank" rel="nofollow noopener noreferrer">linkerd</a> (2.0) another service mesh has its own rust based proxy</p>
<h2 id="custom-resource-definition-crd"><a href="#custom-resource-definition-crd" aria-hidden="true"><span class="icon icon-link"></span></a>Custom Resource Definition (CRD)</h2>
<p>Kubernetes provides an ability to define your own resources (similar to Service, Pod, Deployment, ReplicaSet, etc) and you can also use the kubectl commands to interact with these resources like any kubernetes resource. Almost all the service mesh implementations create their own custom resource definitions to manage and control the components they create.</p>
<h2 id="kubernetes-operator"><a href="#kubernetes-operator" aria-hidden="true"><span class="icon icon-link"></span></a>Kubernetes Operator</h2>
<p>Operators in kubernetes are more like automation bots. Repeated things that are usually handled by operations team can be converted to operators. In that aspect, even a deployment resource is an inbuilt operator that knows how to scale up / down the resources based on its config.</p>
<p>Service mesh implementations use different operators to automate the actions to be taken based on the events that happen in the cluster</p>
<h1 id="toc-section-3"><a href="#what-can-a-service-mesh-do" aria-hidden="true"><span class="icon icon-link"></span></a>What can a service mesh do?</h1>
<p>Let us see some of the scenarios that ops team faces and how they can handle it in their kubernetes cluster</p>
<p>Q: Which of my micro service is under lot of load? why?<br>
A: No idea. Default Kubernetes setup does not help to answer this. We could deploy a <a href="https://medium.com/tarkalabs/know-kubernetes-pictorially-f6e6a0052dd0#28fc" target="_blank" rel="nofollow noopener noreferrer">sidecar proxy</a> to our pods so that it can send service level metrics to some monitoring server like Prometheus. Or, deploy a service mesh which does this automatically</p>
<p>Q: How to keep my customers using at least some parts of the system when a dependent service becomes sluggish?<br>
A: Configure circuit breakers in the sidecar proxies so that the calling services can respond quickly when its dependent services become sluggish / fail. Or, install and configure the service mesh to do this declaratively</p>
<p>Q: My services east to west traffic is across regions / datacenters, How to secure the communication?<br>
A: Switch to mTLS with a local CA so that the services know they are talking to the authentic services. Or, you guessed it right. Install service mesh</p>
<p>Q: How can I get a picture of the traffic flow between the services I manage?<br>
A: Solutions like Weave Scope and KubeView give only the resource dependencies graph but not the live traffic status. Configure sidecar to emit these. Or, same here… service mesh</p>
<p>A Service mesh is an abstraction of such solution so that it can be applied to any cluster easily. Service mesh does to managing application traffic as what Kubernetes is to creating and deploying our applications.</p>
<h1 id="toc-section-4"><a href="#how-does-it-do-it" aria-hidden="true"><span class="icon icon-link"></span></a>How does it do it?</h1>
<p>Service mesh injects a sidecar proxy into pods so that all the network traffic flows through to it. This component which is independent from the actual application can be used in lots of interesting ways as described below</p>
<h2 id="secure-communication"><a href="#secure-communication" aria-hidden="true"><span class="icon icon-link"></span></a>Secure Communication</h2>
<img src="/blog/service-mesh-in-kubernetes/service-mesh-4.webp">
<p>Setting up Mutual TLS authentication manually is not a simple task as it involves configuring the certificate authority and handling certificate signing requests sent by each participating service in your cluster. But, with a sidecar proxy, this concern can be handled in one place. And the application will continue to send / receive traffic in http as the sidecar proxy wraps or unwraps the TLS layer</p>
<h2 id="network-monitoring"><a href="#network-monitoring" aria-hidden="true"><span class="icon icon-link"></span></a>Network monitoring</h2>
<img src="/blog/service-mesh-in-kubernetes/service-mesh-5.webp">
<p>Sidecar proxy can also send information about the destination services to a monitoring server like Prometheus to understand the traffic flow patterns. Since this is also done at the sidecar level, the actual application can stay blissfully ignorant of all this.</p>
<p>As you might have notice, this monitoring traffic could overwhelm the network as we could be sending lot of extra network packets. So, many of the service mesh implementations gives us control to enable and monitor them on demand</p>
<h2 id="traffic-management"><a href="#traffic-management" aria-hidden="true"><span class="icon icon-link"></span></a>Traffic management</h2>
<img src="/blog/service-mesh-in-kubernetes/service-mesh-6.webp">
<p>We can also route traffic to different versions of a service based on rules configured at the sidecar proxy level. In the above illustration, all the requests to “/svc-b/user” will hit the V1 of service B whereas all the requests to same service but to a different endpoint “/svc-b/order” will hit the V2 of the service B that is already deployed. This can be used for A/B testing or canary deployments at service level</p>
<h1 id="toc-section-5"><a href="#next-steps" aria-hidden="true"><span class="icon icon-link"></span></a>Next steps</h1>
<p>If you have come this far and think a service mesh will benefit your team, You can explore service mesh implementations like Istio / Linkerd / Consul. Each have their own feature sets and manages the service mesh bit differently (which would be an interesting post on its own). It would be worth spending some time on the upcoming <a href="https://smi-spec.io/" target="_blank" rel="nofollow noopener noreferrer">Service Mesh Interface</a> which provides standardization across different implementations</p>
<p>Happy meshing!</p>
</div><hr data-v-996dafb6><div class="inner-section" data-v-996dafb6><div class="author-basic-info" data-v-996dafb6><img src="/assets/img/sudhakar.84c96111.jpg" alt="Sudhakar Rayavaram" width="64" data-v-996dafb6><div data-v-996dafb6><p class="heading-size-9 capitalize" data-v-996dafb6>Sudhakar Rayavaram</p><p class="body-jetbrains-size-10" data-v-996dafb6>
            Developer
          </p></div></div><p class="body-opensans-size-9" data-v-996dafb6>Programming is overrated. I mean, there is more to solving a real world problem than writing code</p><div class="social-links" data-v-996dafb6><!----><a href="https://www.linkedin.com/in/sudocker/" target="_blank" class="heading-size-9" data-v-996dafb6>
          LinkedIn
        </a><a href="https://medium.com/@suDocker" target="_blank" class="heading-size-9" data-v-996dafb6>
          Medium
        </a></div></div><hr data-v-996dafb6><div class="related-articles" data-v-996dafb6><div class="flex-space-between" data-v-996dafb6><p class="heading-size-7" data-v-996dafb6>_related articles</p><a href="/blogs" class="heading-size-9 underline" data-v-996dafb6>View all</a></div><div class="flex-space-between blog-card-wrapper" data-v-996dafb6><a href="/blogs/smart-contracts-store-information" class="blog-card" data-v-996dafb6><img src="/assets/img/default-cover.55254b66.png" alt="Blockchain FTW" class="thumbnail" data-v-996dafb6><div class="info" data-v-996dafb6><p class="heading-size-10 capitalize" data-v-996dafb6>/web</p><h3 data-v-996dafb6>Blockchain as public ledger</h3><p class="body-jetbrains-size-10" data-v-996dafb6>
              Rahul Nitin Padalkar   5 min read
            </p></div></a><a href="/blogs/using-tarka-chat-in-your-react-vue-apps" class="blog-card" data-v-996dafb6><img src="/assets/img/Photo-by-Volodymyr-Hryshchenko-on-Unsplash.97698903.webp" alt="Using Tarka Chat in your React/Vue apps" class="thumbnail" data-v-996dafb6><div class="info" data-v-996dafb6><p class="heading-size-10 capitalize" data-v-996dafb6>/web</p><h3 data-v-996dafb6>Using Tarka Chat in your React/Vue apps</h3><p class="body-jetbrains-size-10" data-v-996dafb6>
              Shamil Siddique   5 min read
            </p></div></a></div></div><div class="lets-talk" data-v-188e6a71><div class="message heading-size-7" data-v-188e6a71>
    Let’s build digital solutions together.
  </div><div class="action-container" data-v-188e6a71><div class="action-button heading-size-5" data-v-188e6a71><div data-v-188e6a71>Get in touch</div><div class="arrow" data-v-188e6a71>-&gt;</div></div><img src="/assets/img/talk.71d1d2f3.svg" alt="Lenny Face" data-v-188e6a71></div></div></div></div><div data-v-996dafb6></div></div><div id="footer" class="baseLayout" data-v-996dafb6 data-v-b5a9baaa><div data-v-996dafb6></div><div data-v-996dafb6><div class="site-footer" data-v-0a037a4b data-v-b5a9baaa><ul class="main-nav footer" data-v-748716d7 data-v-0a037a4b><div class="primary fadeIn" data-v-748716d7><li data-v-748716d7><a href="/genai" data-v-748716d7>/GenAI</a></li><li data-v-748716d7><a href="https://design.tarkalabs.com/" target="_self" data-v-748716d7>/Design</a></li><li data-v-748716d7><a href="/develop" data-v-748716d7>/Develop</a></li><li data-v-748716d7><a href="/case-studies" data-v-748716d7>
        /Case_Studies
      </a></li><li data-v-748716d7><a href="/careers" data-v-748716d7>/Careers</a></li><li data-v-748716d7><a href="/about" data-v-748716d7>/About</a></li><li data-v-748716d7><a href="/contact" data-v-748716d7>/Contact</a></li></div></ul><div class="subnav" data-v-0a037a4b><ul class="sub body-jetbrains-size-11 footer fadeIn" data-v-3cc3824e data-v-0a037a4b><li data-v-3cc3824e><a href="/blogs" class="active" data-v-3cc3824e>/blogs</a></li><li data-v-3cc3824e><a href="/talks" data-v-3cc3824e>/talks</a></li><li data-v-3cc3824e><a href="/train" data-v-3cc3824e>/train</a></li></ul><div data-v-fae945d8 data-v-0a037a4b><a href="https://twitter.com/tarkalabs" target="_blank" rel="noopener" class="external" data-v-fae945d8>Twitter</a><a href="https://in.linkedin.com/company/tarka-labs" target="_blank" rel="noopener" class="external" data-v-fae945d8>LinkedIn</a></div><div class="sedin" data-v-0a037a4b><a href="https://sedintechnologies.com/" target="_blank" rel="noopener" class="external" data-v-0a037a4b>Tarka Labs is a division of Sedin Technologies</a></div></div></div></div><div data-v-996dafb6></div></div></div></div></div>
    <script src="/assets/js/app.8e7b5054.js" defer></script><script src="/assets/js/page--src--templates--blog-vue.2099f288.js" defer></script><script data-vue-tag="ssr" src="https://unpkg.com/@lottiefiles/lottie-player@0.4.0/dist/lottie-player.js" data-body="true"></script>
  </body>
</html>
