{"hash":"985f79b54c8ea35eabb5e469f3daecd8538b11d8","data":{"caseStudy":{"id":"4f832b99277f092bdbca85f0c149cc79","title":"Hotstar","clientId":27,"bannerText":"How to build mobile user interfaces that are fluid?","tech":"swift, ios","content":"<style>\n  figure {\n    text-align: center;\n  }\n  .casestudy figure img {\n      height:600px; \n      width: auto !important;\n    }\n</style>\n<h1 id=\"brief\"><a href=\"#brief\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Brief</h1>\n<h2 id=\"we-joined-hands-with-hotstar-in-augmenting-their-team-to-build-their-next-generation-mobile-experience\"><a href=\"#we-joined-hands-with-hotstar-in-augmenting-their-team-to-build-their-next-generation-mobile-experience\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>We joined hands with Hotstar in augmenting their team to build their next generation mobile experience</h2>\n<p>Hotstar is an online video streaming platform that offers a variety of content, including drama, movies, and live sports. It is owned by The Walt Disney Company India and operated by Disney Streaming, both part of Disney Entertainment. Hotstar is one of the dominant streaming services in India, with over 300 million active users.</p>\n<p>In their mission to build next generation mobile experience, Internal design team redesigned their mobile app for better user experience and to improve the user retention.</p>\n<p>As experts in iOS development, we were engaged to enrich their internal team to make this redesign a reality with sound software development principles.</p>\n<figure>\n  <img src=\"/hotstar/one.png\" alt=\"Hotstar mobile app view\" />\n</figure>\n<h1 id=\"challenges\"><a href=\"#challenges\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Challenges</h1>\n<h2 id=\"how-will-you-organise-fluid-design-components-that-are-composable-customizable-and-reusable\"><a href=\"#how-will-you-organise-fluid-design-components-that-are-composable-customizable-and-reusable\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How will you organise fluid design components that are composable, customizable and reusable?</h2>\n<p>The mobile application was designed with motion design principles. This means, every component will animate in harmony with other components based on the user interations like scroll, swipe and click. Building an iOS mobile application that is interaction rich with reusable components is not a simple task as it would need proper abstraction and well planned component composition.</p>\n<h2 id=\"how-will-you-handle-different-animations-happening-at-the-same-time\"><a href=\"#how-will-you-handle-different-animations-happening-at-the-same-time\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How will you handle different animations happening at the same time?</h2>\n<h3 id=\"gesture-based-animations\"><a href=\"#gesture-based-animations\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Gesture-based animations</h3>\n<p>We needed to implement both vertical as well as horizontal animations that could be triggered by a scroll gesture from the user. The type of animation in each direction was different - vertically, we needed a parallax animation, whereas horizontally, we needed a pan animation with crossfading and movement offsets.\nApart from the above, we also needed to support a slow panning gesture as well as a fast flick gesture, and also needed to auto-complete the animation when the pan gesture crossed a particular threshold. </p>\n<h3 id=\"timed-animations\"><a href=\"#timed-animations\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Timed animations</h3>\n<p>Not only did the animations need to work when the user performed a scrolling action, they also needed to run on a fixed timed interval that was determined on the backend. We needed to ensure that the user-triggered and automated animations did not conflict with each other in any way.</p>\n<h3 id=\"smooth-animations\"><a href=\"#smooth-animations\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Smooth animations</h3>\n<p>To ensure that the animations were smooth without any perceptible lags or hiccups, we needed to synchronize the animation with the device's refresh rate, whether it was 60hz or 120hz on the latest models.\nReversible animations\nWe needed to ensure that the animation could be reversed to the starting position, if the user did not complete the pan gesture fully.</p>\n<h3 id=\"infinite-scrolling\"><a href=\"#infinite-scrolling\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Infinite scrolling</h3>\n<p>If the user reached the end of the list of items in the masthead on either side, we needed to allow them to loop back to the start or end again.</p>\n<h1 id=\"solution\"><a href=\"#solution\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Solution</h1>\n<p>Given the multiple requirements and challenges, the solution was not as simple as just using the UIView animateWithDuration APIs to drive the animation. Here’s how we implemented it</p>\n<h2 id=\"ui-view-hierarchy\"><a href=\"#ui-view-hierarchy\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>UI view hierarchy</h2>\n<p>We used a simple UITableView to host the contents of the home page, including the masthead component. UICollectionView was a no-go, because improvements that would allow us to use it for list-like UI, such as compositional layouts, were only introduced in iOS 13. This also meant that we had to use UIKit, and not SwiftUI as that was also an iOS 13 introduction.</p>\n<p>Within the table view, each cell contained a separate component, and the masthead component was one such. The masthead itself consisted of a horizontally scrolling collection view. </p>\n<figure>\n  <img src=\"/hotstar/two.png\" alt=\"Hotstar mobile app view\" />\n</figure>\n<h2 id=\"implementing-the-vertical-scroll-parallax-animation\"><a href=\"#implementing-the-vertical-scroll-parallax-animation\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Implementing the vertical scroll parallax animation</h2>\n<p>Because the root view was a table view, we were able to listen to UIScrollView delegate methods and obtain the scroll offset using the <code>scrollView:didScroll</code> method. The current scroll offset was broadcast as an event using RxSwift, and was listened to by the masthead component. The component then further broadcast it to the current visible cell of the internal collection view, where we updated the auto layout constraints to move the necessary subviews in the opposite direction of the scroll, giving a parallax effect. </p>\n<p>We used RxSwift instead of say NSNotifications, as the former allowed us to expose a type-safe BehaviourSubject containing a CGPoint of the current vertical offset. With Notifications, we would’ve needed to package the CGPoint in an untyped [String: Any] userinfo dictionary, and then cast the value when consuming the notification.</p>\n<figure>\n  <img src=\"/hotstar/three.gif\" alt=\"Hotstar mobile app view\" />\n</figure>\n<h2 id=\"implementing-the-user-triggered-horizontal-animation\"><a href=\"#implementing-the-user-triggered-horizontal-animation\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Implementing the user-triggered horizontal animation</h2>\n<p>The first thing we did to support the custom animation that we wanted is to disable scrolling on the internal collection view, because we simply did not want the default scroll experience. </p>\n<p>Instead, we used a separate pan gesture, and manually transformed the collection view cells and its subviews when the gesture updated, to make it look like the collection view was scrolling during the animation. </p>\n<p>Whenever the pan gesture updated, we did the following:\nWe stored the “translation” of the pan gesture, aka the distance that the user has moved using the gesture\nTo ensure that the animation happened without any jitters or dropped frames, we used a CADisplayLink to drive it. When a display link is configured and added to the runloop, it gives us a callback everytime the screen is refreshed. In this callback, we calculated the progress of the animation based on the translation stored above. Since this happens on every refresh, no frames are missed out or dropped.\nWe then broadcast the progress to two individual cells - the current cell being animated out, and the next cell being animated in. They update their subviews accordingly - for example, the current cell would animate out the title to the side, and fade out its poster image. The next cell would animate in the title from the side, and fade in its poster.</p>\n<p>Once the animation was complete, we then scrolled the collectionview to the new indexPath, albeit without any animation of its own, so that its internal state is up-to-date with what is on screen. </p>\n<figure>\n  <img src=\"/hotstar/four.gif\" alt=\"Hotstar mobile app view\" />\n</figure>\n<h2 id=\"implementing-the-automatic-horizontal-animation\"><a href=\"#implementing-the-automatic-horizontal-animation\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Implementing the automatic horizontal animation</h2>\n<p>We used a Timer instance to automatically scroll the masthead on a fixed interval, when the user wasn't actively scrolling it.</p>\n<p>When the timer got fired, we simply unpaused the display link, allowing it to drive the animation from start to finish. Instead of using a gesture’s translation to calculate progress, we used the display link’s timestamp during each of its callbacks, to determine how much time has elapsed, and then using the animation’s total duration, we arrived at the progress. Once the animation was completed, we scheduled the timer again, so that it can run one more time as needed.</p>\n<p>In some cases, we did not want the timer to fire. For example, if the user was performing some other action such as scrolling the tableview, we did not want to distract them with an auto-scrolling masthead. To achieve this, we added the timer to the main runloop using the default mode, as opposed to the common mode. In the default mode, the runloop is blocked by other events on it - in this case pausing the timer.  As an extra precaution, we also added a check to prevent it from activating whenever the pan gesture to manually scroll horizontally was active. </p>\n<h1 id=\"outcome\"><a href=\"#outcome\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Outcome</h1>\n<p>The redesigned UI of our client’s mobile app with a homepage layout consisting of both parallax vertical animations and a custom horizontal scroll transition is now available on iOS. In this day and age, it is critical for mobile apps to stand out with a polished UX that delights users, and we helped our client achieve just that with our implementation of the Masthead component</p>\n"},"clients":{"edges":[{"node":{"id":"27","name":"Hotstar","style":"fullBlack","logo":"org/hotstar.png"}},{"node":{"id":"26","name":"Framework","style":"fullBlack","logo":"org/framework.svg"}},{"node":{"id":"25","name":"Routinr","style":"purple-blue","logo":"org/routinr.svg"}},{"node":{"id":"24","name":"eVisitNB","style":"red","logo":""}},{"node":{"id":"23","name":"EquipmentFX","style":"yellow","logo":""}},{"node":{"id":"22","name":"Beatclub","style":"dark-grey","logo":"org/beatclub.svg"}},{"node":{"id":"21","name":"Social Lab","style":"yellow","logo":""}},{"node":{"id":"20","name":"IFAD","style":"yellow","logo":""}},{"node":{"id":"19","name":"10i Commerce","style":"dark-blue","logo":""}},{"node":{"id":"18","name":"IDExcel","style":"grey","logo":""}},{"node":{"id":"17","name":"Aisle","style":"green","logo":""}},{"node":{"id":"16","name":"Trazaar","style":"yellow","logo":""}},{"node":{"id":"15","name":"Jiffle Now","style":"pink","logo":""}},{"node":{"id":"14","name":"Farmstead","style":"green","logo":""}},{"node":{"id":"13","name":"Inkl","style":"dark-blue","logo":""}},{"node":{"id":"12","name":"Glydel","style":"grey","logo":""}},{"node":{"id":"11","name":"Messaging Solution Provider","style":"black","logo":""}},{"node":{"id":"10","name":"EAM360","style":"red","logo":""}},{"node":{"id":"9","name":"TuneCore","style":"black","logo":""}},{"node":{"id":"8","name":"Abridge","style":"orange","logo":""}},{"node":{"id":"7","name":"GE Digital Services","style":"green","logo":""}},{"node":{"id":"6","name":"Gaea Global","style":"red","logo":""}},{"node":{"id":"5","name":"Genetic Direction","style":"dark-blue","logo":""}},{"node":{"id":"4","name":"IDEO","style":"yellow","logo":""}},{"node":{"id":"3","name":"Fankave","style":"black","logo":""}},{"node":{"id":"2","name":"Caratlane","style":"blue","logo":""}},{"node":{"id":"1","name":"Modus","style":"pink","logo":""}}]}},"context":{}}